!function(n){var e={};function r(t){if(e[t])return e[t].exports;var i=e[t]={i:t,l:!1,exports:{}};return n[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=n,r.c=e,r.d=function(t,i,n){r.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(i,t){if(1&t&&(i=r(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.__esModule)return i;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var e in i)r.d(n,e,function(t){return i[t]}.bind(null,e));return n},r.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},r.p="",r(r.s=0)}([function(t,i,n){var e=n(1),r=n(3);window.L.CanvasIconLayer=r(L),window.rbush=e},function(t,i,n){"use strict";t.exports=e,t.exports.default=e;var s=n(2);function e(t,i){if(!(this instanceof e))return new e(t,i);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&this._initFormat(i),this.clear()}function c(t,i,n){if(!n)return i.indexOf(t);for(var e=0;e<i.length;e++)if(n(t,i[e]))return e;return-1}function f(t,i){g(t,0,t.children.length,i,t)}function g(t,i,n,e,r){(r=r||d(null)).minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,a=i;a<n;a++)o=t.children[a],l(r,t.leaf?e(o):o);return r}function l(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function o(t,i){return t.minX-i.minX}function a(t,i){return t.minY-i.minY}function x(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function m(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function u(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _(t,i,n,e,r){for(var o,a=[i,n];a.length;)(n=a.pop())-(i=a.pop())<=e||(o=i+Math.ceil((n-i)/e/2)*e,s(t,o,i,n,r),a.push(i,o,o,n))}e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var i=this.data,n=[],e=this.toBBox;if(!u(t,i))return n;for(var r,o,a,s,h=[];i;){for(r=0,o=i.children.length;r<o;r++)a=i.children[r],u(t,s=i.leaf?e(a):a)&&(i.leaf?n.push(a):m(t,s)?this._all(a,n):h.push(a));i=h.pop()}return n},collides:function(t){var i=this.data,n=this.toBBox;if(!u(t,i))return!1;for(var e,r,o,a,s=[];i;){for(e=0,r=i.children.length;e<r;e++)if(o=i.children[e],u(t,a=i.leaf?n(o):o)){if(i.leaf||m(t,a))return!0;s.push(o)}i=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0,n=t.length;i<n;i++)this.insert(t[i]);return this}var e=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){var r=this.data;this.data=e,e=r}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=d([]),this},remove:function(t,i){if(!t)return this;for(var n,e,r,o,a=this.data,s=this.toBBox(t),h=[],u=[];a||h.length;){if(a||(a=h.pop(),e=h[h.length-1],n=u.pop(),o=!0),a.leaf&&-1!==(r=c(t,a.children,i)))return a.children.splice(r,1),h.push(a),this._condense(h),this;o||a.leaf||!m(a,s)?e?(n++,a=e.children[n],o=!1):a=null:(h.push(a),u.push(n),n=0,a=(e=a).children[0])}return this},toBBox:function(t){return t},compareMinX:o,compareMinY:a,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},_build:function(t,i,n,e){var r,o=n-i+1,a=this._maxEntries;if(o<=a)return f(r=d(t.slice(i,n+1)),this.toBBox),r;e||(e=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,e-1))),(r=d([])).leaf=!1,r.height=e;var s,h,u,c,l=Math.ceil(o/a),p=l*Math.ceil(Math.sqrt(a));for(_(t,i,n,p,this.compareMinX),s=i;s<=n;s+=p)for(_(t,s,u=Math.min(s+p-1,n),l,this.compareMinY),h=s;h<=u;h+=l)c=Math.min(h+l-1,u),r.children.push(this._build(t,h,c,e-1));return f(r,this.toBBox),r},_chooseSubtree:function(t,i,n,e){for(var r,o,a,s,h,u,c,l,p,f;e.push(i),!i.leaf&&e.length-1!==n;){for(c=l=1/0,r=0,o=i.children.length;r<o;r++)h=x(a=i.children[r]),p=t,f=a,(u=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-h)<l?(l=u,c=h<c?h:c,s=a):u===l&&h<c&&(c=h,s=a);i=s||i.children[0]}return i},_insert:function(t,i,n){var e=this.toBBox,r=n?t:e(t),o=[],a=this._chooseSubtree(r,this.data,i,o);for(a.children.push(t),l(a,r);0<=i&&o[i].children.length>this._maxEntries;)this._split(o,i),i--;this._adjustParentBBoxes(r,o,i)},_split:function(t,i){var n=t[i],e=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,e);var o=this._chooseSplitIndex(n,r,e),a=d(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,f(n,this.toBBox),f(a,this.toBBox),i?t[i-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,i){this.data=d([t,i]),this.data.height=t.height+1,this.data.leaf=!1,f(this.data,this.toBBox)},_chooseSplitIndex:function(t,i,n){var e,r,o,a,s,h,u,c,l,p,f,m,d,_;for(h=u=1/0,e=i;e<=n-i;e++)r=g(t,0,e,this.toBBox),o=g(t,e,n,this.toBBox),l=r,p=o,void 0,f=Math.max(l.minX,p.minX),m=Math.max(l.minY,p.minY),d=Math.min(l.maxX,p.maxX),_=Math.min(l.maxY,p.maxY),a=Math.max(0,d-f)*Math.max(0,_-m),s=x(r)+x(o),a<h?(h=a,c=e,u=s<u?s:u):a===h&&s<u&&(u=s,c=e);return c},_chooseSplitAxis:function(t,i,n){var e=t.leaf?this.compareMinX:o,r=t.leaf?this.compareMinY:a;this._allDistMargin(t,i,n,e)<this._allDistMargin(t,i,n,r)&&t.children.sort(e)},_allDistMargin:function(t,i,n,e){t.children.sort(e);var r,o,a=this.toBBox,s=g(t,0,i,a),h=g(t,n-i,n,a),u=p(s)+p(h);for(r=i;r<n-i;r++)o=t.children[r],l(s,t.leaf?a(o):o),u+=p(s);for(r=n-i-1;i<=r;r--)o=t.children[r],l(h,t.leaf?a(o):o),u+=p(h);return u},_adjustParentBBoxes:function(t,i,n){for(var e=n;0<=e;e--)l(i[e],t)},_condense:function(t){for(var i,n=t.length-1;0<=n;n--)0===t[n].children.length?0<n?(i=t[n-1].children).splice(i.indexOf(t[n]),1):this.clear():f(t[n],this.toBBox)},_initFormat:function(t){var i=["return a"," - b",";"];this.compareMinX=new Function("a","b",i.join(t[0])),this.compareMinY=new Function("a","b",i.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,i,n){t.exports=function(){"use strict";function d(t,i,n,e,r){for(;n<e;){if(600<e-n){var o=e-n+1,a=i-n+1,s=Math.log(o),h=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*h*(o-h)/o)*(a-o/2<0?-1:1),c=Math.max(n,Math.floor(i-a*h/o+u)),l=Math.min(e,Math.floor(i+(o-a)*h/o+u));d(t,i,c,l,r)}var p=t[i],f=n,m=e;for(_(t,n,i),0<r(t[e],p)&&_(t,n,e);f<m;){for(_(t,f,m),f++,m--;r(t[f],p)<0;)f++;for(;0<r(t[m],p);)m--}0===r(t[n],p)?_(t,n,m):_(t,++m,e),m<=i&&(n=m+1),i<=m&&(e=m-1)}}function _(t,i,n){var e=t[i];t[i]=t[n],t[n]=e}function o(t,i){return t<i?-1:i<t?1:0}return function(t,i,n,e,r){d(t,i,n||0,e||t.length-1,r||o)}}()},function(t,i,n){"use strict";t.exports=function(r){function t(t,i){function n(){this.init&&this.init.apply(this,arguments)}var e=r.Util.create(t.prototype);return r.Util.extend(e,i),n.prototype=e,n}var i=t(rbush,{init:function(){rbush.apply(this,arguments),this._batch=[]},insert:function(t,i){return i?(this._batch.push(t),this):rbush.prototype.insert.call(this,t)},flush:function(){return this.load(this._batch),this._batch.length=0,this}}),n=t(i,{toBBox:function(t){var i=t._latlng;return{minX:i.lng,minY:i.lat,maxX:i.lng,maxY:i.lat}},compareMinX:function(t,i){return t._latlng.lng-i._latlng.lng},compareMinY:function(t,i){return t._latlng.lat-i._latlng.lat},searchIn:function(t){return this.search({minX:t.getWest(),minY:t.getSouth(),maxX:t.getEast(),maxY:t.getNorth()})},init:function(){i.prototype.init.apply(this,arguments),this._dirty=0,this._total=0},cleanup:function(){if(.1<=this._dirty/this._total){var t=this.all();this.clear(),this._dirty=0,this.load(t)}return this},insert:function(){return this._dirty++,this._total++,i.prototype.insert.apply(this,arguments)},remove:function(){return this._total--,i.prototype.remove.apply(this,arguments)},clear:function(){return this._dirty=0,this._total=0,rbush.prototype.clear.apply(this)}}),e=t(i,{toBBox:function(t){var i=t.options.icon.options.iconSize,n=t._point,e=i[0]/2,r=i[1]/2;return{minX:n.x-e,minY:n.y-r,maxX:n.x+e,maxY:n.y+r}},compareMinX:function(t,i){return t._point.x-i._point.x},compareMinY:function(t,i){return t._point.y-i._point.y},searchBy:function(t){return this.search({minX:t.x,minY:t.y,maxX:t.x,maxY:t.y})}}),o=r.Layer.extend({options:r.Canvas.prototype.options,initialize:function(t){r.Renderer.prototype.initialize.call(this,t),this._pointsIdx=new e,this._latlngsIdx=new n},onAdd:function(){r.Renderer.prototype.onAdd.call(this),r.DomUtil.toBack(this._container)},_initContainer:function(){r.Canvas.prototype._initContainer.call(this),this._hideContainer(!0)},onRemove:function(){r.Renderer.prototype.onRemove.call(this)},_destroyContainer:function(){r.Canvas.prototype._destroyContainer.call(this),this._pointsIdx.clear()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,click:this._onClick,mousemove:this._onMouseMove,mouseout:this._handleMouseOut};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){r.Renderer.prototype._onAnimZoom.call(this,t)},_onZoom:function(){r.Renderer.prototype._onZoom.call(this)},_updateTransform:function(t,i){r.Renderer.prototype._updateTransform.call(this,t,i)},_updatePaths:r.Util.falseFn,_update:function(){r.Canvas.prototype._update.call(this),this._draw()},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom)},_redraw:function(){r.Canvas.prototype._redraw.call(this)},_clear:function(){r.Canvas.prototype._clear.call(this)},_draw:function(){var t=this._redrawBounds;if(t){var i=t.getSize();this._ctx.beginPath(),this._ctx.rect(t.min.x,t.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0,this._latlngsIdx.cleanup();var n=this._map.getBounds().pad(this.options.padding),e=!0;this._latlngsIdx.searchIn(n).forEach(function(t){t._map||(t._map=this._map),this._drawMarker(t),this._pointsIdx.insert(t,!0),e=!1},this),this._drawing=!1,this._pointsIdx.clear().flush(),this._hideContainer(e)},_drawMarker:function(t){t._point=this._map.latLngToLayerPoint(t.getLatLng()),this._imageLookup=this._imageLookup||{};var i=t.options.icon.options.iconUrl,n=this._imageLookup[i];if(t.canvas_img)n.loaded&&this._drawImage(t);else if(n)t.canvas_img=n.img,n.loaded?this._drawImage(t):n.queue.push(t);else{var e=new Image;e.src=i,t.canvas_img=e,n={loaded:!1,img:e,queue:[t]},this._imageLookup[i]=n,e.onload=function(){n.loaded=!0,n.queue.forEach(function(t){this.hasLayer(t)&&this._drawImage(t)},this)}.bind(this)}},_drawImage:function(t){var i=t.options.icon.options,n=t._point.subtract(i.iconAnchor);this._ctx.drawImage(t.canvas_img,n.x,n.y,i.iconSize[0],i.iconSize[1])},_onClick:function(t){var i,n=t.layerPoint||this._map.mouseEventToLayerPoint(t),e=this._pointsIdx&&this._pointsIdx.searchBy(n);e&&e.forEach(function(t){t.options.interactive&&!this._map._draggableMoved(t)&&(i=t)},this),i&&(r.DomEvent.fakeStop(t),this._fireEvent([i],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var i=t.layerPoint||this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,i)}},_handleMouseHover:function(t,i){if(!this._mouseHoverThrottled){var n,e=this._pointsIdx&&this._pointsIdx.searchBy(i);e&&e.forEach(function(t){t.options.interactive&&(n=t)},this),n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(r.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(r.bind(function(){this._mouseHoverThrottled=!1},this),32)}},_handleMouseOut:function(t){r.Canvas.prototype._handleMouseOut.call(this,t)},_fireEvent:function(t,i,n){i.layerPoint?t[0].fire(n||i.type,i,!0):r.Canvas.prototype._fireEvent.call(this,t,i,n)},_addMarker:function(t,i,n,e){if(!(t instanceof r.Marker))throw new Error("Layer isn't a marker");t._map=this._map,r.Util.stamp(t),t.addEventParent(this),n&&(this._drawMarker(t),this._pointsIdx.insert(t,e),this._hideContainer(!1)),this._latlngsIdx.insert(t,e)},addMarker:function(t,i){i=i?i.toString():"0",this._groupIDs=this._groupIDs||{};var n=t.getLatLng(),e=this._map&&this._map.getBounds().pad(this.options.padding).contains(n);return this._addMarker(t,n,e),this._groupIDs[i]=(this._groupIDs[i]||0)+1,t._canvasGroupID=i,this},addLayer:function(t,i){return this.addMarker(t,i)},addMarkers:function(t,e){e=e?e.toString():"0",this._groupIDs=this._groupIDs||{},this._groupIDs[e]=this._groupIDs[e]||0;var r=this._map&&this._map.getBounds().pad(this.options.padding);return t.forEach(function(t){var i=t.getLatLng(),n=r&&r.contains(i);this._addMarker(t,i,n,!0),this._groupIDs[e]++,t._canvasGroupID=e},this),this._pointsIdx.flush(),this._latlngsIdx.flush(),this},addLayers:function(t,i){return this.addMarkers(t,i)},removeGroups:function(t){return t.forEach(function(t){this._removeGroup(t)},this),this._redraw(),this},removeGroup:function(t){return this._removeGroup(t),this._redraw(),this},_removeGroup:function(i){i=i.toString(),this._groupIDs[i]&&(delete this._groupIDs[i],this._latlngsIdx.all().filter(function(t){return t._canvasGroupID===i}).forEach(function(t){this.removeMarker(t,!1,!0)},this))},removeMarker:function(t,i,n){if(n||this.hasLayer(t))return this._latlngsIdx.remove(t),i&&this._map&&this._map.getBounds().pad(this.options.padding).contains(t.getLatLng())&&this._redraw(),t.removeEventParent(this),this},removeLayer:function(t){return this.removeMarker(t,!0)},clearLayers:function(){return this._latlngsIdx.clear(),this._pointsIdx.clear(),this._clear(),this},hasLayer:function(t){return t._eventParents[r.Util.stamp(this)]},_hideContainer:function(t){this._isEmpty!==t&&(this._isEmpty=t,this._container.style.display=t?"none":"initial")}});return r.canvasIconLayer=function(t){return new o(t)},o}}]);